#!/bin/bash
set -eux

. "$(dirname "$(readlink -f "$0")")"/functions.sh

MURANO_REF=${MURANO_REF:-'stable/mitaka'}
MURANO_PACKAGE_RELEASE=${MURANO_PACKAGE_RELEASE:-'9.0'}
MURANO_TARBALL_URL=${MURANO_TARBALL_URL:-"https://github.com/openstack/puppet-murano/archive/${MURANO_REF}.tar.gz"}

# Add murano packages and some dependencies
MURANO_PACKAGES_URLS_DEFAULT="http://mirror.fuel-infra.org/extras/murano-plugin-repos/ubuntu/${MURANO_PACKAGE_RELEASE}/pool/main/"

MURANO_PACKAGES_URLS=${MURANO_PACKAGES_URLS:-${MURANO_PACKAGES_URLS_DEFAULT}}

for url in ${MURANO_PACKAGES_URLS}; do
  download_package 'deb' "${url}"
done

download_puppet_module "murano" ${MURANO_TARBALL_URL}
